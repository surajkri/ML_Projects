# -*- coding: utf-8 -*-
"""House_Price_Prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1imL91XZOH_Z9opZbi-3qWEbzCTDDpgXv
"""

import numpy as np
import pandas as pd
import seaborn as snr

data=pd.read_csv("/content/sample_data/Housing (1).csv")

data.info()

data.isnull()

data.isnull().sum()

data.head()

data.fillna(data.median())

data['mainroad']=data['mainroad'].apply({'yes':1,'no':0}.get)
data['basement']=data['basement'].apply({'yes':1,'no':0}.get)
data['guestroom']=data['guestroom'].apply({'yes':1,'no':0}.get)
data['hotwaterheating']=data['hotwaterheating'].apply({'yes':1,'no':0}.get)
data['airconditioning']=data['airconditioning'].apply({'yes':1,'no':0}.get)
data['prefarea']=data['prefarea'].apply({'yes':1,'no':0}.get)
data['furnishingstatus']=data['furnishingstatus'].apply({'furnished':1,'semi-furnished':2,'unfurnished':3}.get)

data.head()

x=data[['area','bedrooms','bathrooms','stories','mainroad','guestroom','basement','hotwaterheating','airconditioning','parking','prefarea','furnishingstatus']]
y=data[['price']]

from sklearn.model_selection import train_test_split

x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.2)

x_train.shape

y_train.shape

x_test.shape

y_test.shape

from sklearn.linear_model import LinearRegression
lregression=LinearRegression()

from sklearn.ensemble import RandomForestRegressor
rfregression=RandomForestRegressor(n_estimators=50,random_state=0)

lregression.fit(x_train,y_train)

rfregression.fit(x_train,y_train)

lregression.predict(x_test)

rfregression.predict(x_test)

lregression.score(x,y)

rfregression.score(x,y)

new_data={'area':7420,'bedrooms':4,'bathrooms':2,'stories':3,'mainroad':1,'guestroom':0,	'basement':0,	'hotwaterheating':0,	'airconditioning':1,	'parking':2	,'prefarea':1,'furnishingstatus':1}

new=pd.DataFrame(new_data,index=[1])

lregression.predict(new)

rfregression.predict(new)

